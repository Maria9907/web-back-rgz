{% extends "base.html" %}

{% block title %}–ü–æ–∏—Å–∫ –ª–µ–∫–∞—Ä—Å—Ç–≤{% endblock %}

{% block content %}
<div class="container">
    <h1>–ü–æ–∏—Å–∫ –ª–µ–∫–∞—Ä—Å—Ç–≤</h1>
    
    <form method="GET" action="{{ url_for('search_medicines') }}" class="search-form">
        <div class="form-row">
            <div class="form-group">
                <label for="name">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                <input type="text" id="name" name="name" 
                       value="{{ search_params.get('name', '') }}"
                       placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞">
            </div>
            
            <div class="form-group">
                <label for="min_price">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞:</label>
                <input type="number" id="min_price" name="min_price" step="0.01" min="0"
                       value="{{ search_params.get('min_price', '') }}"
                       placeholder="0.00">
            </div>
            
            <div class="form-group">
                <label for="max_price">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞:</label>
                <input type="number" id="max_price" name="max_price" step="0.01" min="0"
                       value="{{ search_params.get('max_price', '') }}"
                       placeholder="1000.00">
            </div>
        </div>
        
        <div class="form-group">
            <label for="prescription_required">–†–µ—Ü–µ–ø—Ç—É—Ä–Ω–æ—Å—Ç—å:</label>
            <select id="prescription_required" name="prescription_required">
                <option value="">–í—Å–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã</option>
                <option value="1" {% if search_params.get('prescription_required') == '1' %}selected{% endif %}>
                    –¢–æ–ª—å–∫–æ —Ä–µ—Ü–µ–ø—Ç—É—Ä–Ω—ã–µ
                </option>
                <option value="0" {% if search_params.get('prescription_required') == '0' %}selected{% endif %}>
                    –ë–µ–∑ —Ä–µ—Ü–µ–ø—Ç–∞
                </option>
            </select>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn btn-primary">–ù–∞–π—Ç–∏</button>
            <a href="{{ url_for('search_medicines') }}" class="btn btn-secondary">–°–±—Ä–æ—Å–∏—Ç—å</a>
        </div>
    </form>
    
    {% if medicines %}
        <div class="search-results">
            <h2>–ù–∞–π–¥–µ–Ω–æ –ª–µ–∫–∞—Ä—Å—Ç–≤: {{ total_count }}</h2>
            
            <div class="medicines-grid">
                {% for medicine in medicines %}
                    <div class="medicine-card">
                        <div class="medicine-info">
                            <h3>{{ medicine.name }}</h3>
                            {% if medicine.generic_name %}
                                <p class="generic-name">{{ medicine.generic_name }}</p>
                            {% endif %}
                            {% if medicine.description %}
                                <div class="medicine-description">
                                    <p>{{ medicine.description }}</p>
                                </div>
                            {% endif %}
                            <div class="medicine-details">
                                <span class="price">{{ "%.2f"|format(medicine.price) }} —Ä—É–±.</span>
                                <span class="quantity {{ 'out-of-stock' if medicine.quantity == 0 else 'in-stock' }}">
                                    {% if medicine.quantity == 0 %}
                                        ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
                                    {% else %}
                                        ‚úÖ –í –Ω–∞–ª–∏—á–∏–∏: {{ medicine.quantity }}
                                    {% endif %}
                                </span>
                            </div>
                            
                            {% if medicine.prescription_required %}
                                <span class="prescription-label">üìã –†–µ—Ü–µ–ø—Ç—É—Ä–Ω—ã–π</span>
                            {% else %}
                                <span class="prescription-label">üÜì –ë–µ–∑ —Ä–µ—Ü–µ–ø—Ç–∞</span>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
            
            <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
            {% if total_pages > 1 %}
                <div class="pagination">
                    {% if page > 1 %}
                        <a href="{{ url_for('search_medicines', page=page-1, **search_params) }}" 
                           class="btn btn-secondary">
                            ‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–µ
                        </a>
                    {% endif %}
                    
                    <span class="page-info">
                        –°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page }} –∏–∑ {{ total_pages }}
                    </span>
                    
                    {% if page < total_pages %}
                        <a href="{{ url_for('search_medicines', page=page+1, **search_params) }}" 
                           class="btn btn-secondary">
                            –°–ª–µ–¥—É—é—â–∏–µ ‚Üí
                        </a>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    {% elif request.args %}
        <div class="no-results">
            <h2>–ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h2>
            <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
        </div>
    {% else %}
        <div class="welcome-search">
            <h2>–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤</h2>
            <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –≤—ã—à–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω—É–∂–Ω—ã—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤</p>
        </div>
    {% endif %}
</div>
{% endblock %}